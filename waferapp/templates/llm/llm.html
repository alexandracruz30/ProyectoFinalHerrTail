{% extends "base/base.html" %}
{% load static %}
{% block title %}CNN Model Explorer - Asistente AI{% endblock %}

{% block content %}
<style>
    body { font-family: 'Inter', 'Segoe UI', sans-serif; }
    
    /* Animaciones personalizadas */
    @keyframes fadeInUp {
        from { opacity: 0; transform: translateY(10px); }
        to { opacity: 1; transform: translateY(0); }
    }
    
    @keyframes loadingDots {
        0%, 80%, 100% { transform: scale(0); opacity: 0.5; }
        40% { transform: scale(1); opacity: 1; }
    }
    
    .fade-in-up { animation: fadeInUp 0.3s ease-out; }
    
    .loading-dots span {
        animation: loadingDots 1.4s infinite ease-in-out;
    }
    .loading-dots span:nth-child(1) { animation-delay: -0.32s; }
    .loading-dots span:nth-child(2) { animation-delay: -0.16s; }
    
    /* Scrollbar personalizado */
    .custom-scrollbar::-webkit-scrollbar { width: 6px; }
    .custom-scrollbar::-webkit-scrollbar-track { background: #f1f5f9; border-radius: 3px; }
    .custom-scrollbar::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 3px; }
    .custom-scrollbar::-webkit-scrollbar-thumb:hover { background: #94a3b8; }
    
    .input-scrollbar::-webkit-scrollbar { width: 4px; }
    .input-scrollbar::-webkit-scrollbar-track { background: transparent; }
    .input-scrollbar::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 2px; }
    
    /* Gradientes personalizados */
    .gradient-primary { background: linear-gradient(135deg, #183b6b, #1b325f); }
    .gradient-secondary { background: linear-gradient(135deg, #e97228, #d65d1f); }
    .gradient-bg { background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%); }
    
    /* Efectos de hover */
    .hover-lift:hover { transform: translateY(-1px); }
    .hover-scale:hover { transform: scale(1.02); }
</style>

<main class="min-h-screen bg-gray-100 dark:bg-gray-900 transition-colors duration-300 py-8">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="bg-gray-50 min-h-screen flex items-center justify-center p-4">
    
    <div class="w-full max-w-4xl h-[750px] max-h-[95vh] bg-white rounded-2xl shadow-2xl border-2 border-blue-100 flex flex-col overflow-hidden">
        
        <!-- Área de mensajes -->
        <div id="messagesArea" class="flex-1 p-5 bg-slate-50 border-b border-blue-100 flex flex-col gap-4 overflow-y-auto custom-scrollbar">
            
            <!-- Pantalla de bienvenida -->
            <div id="welcomeScreen" class="flex flex-col items-center justify-center text-center h-full w-full py-10 px-5 text-blue-900">
                <div class="w-20 h-20 gradient-primary rounded-full flex items-center justify-center mb-6 shadow-lg">
                    <i class="fas fa-comments text-2xl text-white"></i>
                </div>
                <h2 class="text-3xl font-bold text-blue-900 mb-3 tracking-tight">¡Hola! Soy tu asistente AI</h2>
                <p class="text-lg text-gray-600 max-w-md leading-relaxed">Pregúntame cualquier cosa y te ayudaré con la mejor respuesta posible. O sube una imagen de una oblea para analizarla.</p>
            </div>
            
        </div>
        
        <!-- Sección de entrada -->
        <div class="h-[12%] p-5 bg-white border-t border-blue-100 flex items-center">
            <form id="llmForm" autocomplete="off" class="w-full h-full flex items-center">
                {% csrf_token %}
                
                <div class="relative w-full h-full flex items-center">
                    <div class="bg-white border-2 border-blue-100 rounded-xl p-2 transition-all duration-200 shadow-sm hover:shadow-md focus-within:border-blue-600 focus-within:shadow-lg focus-within:ring-2 focus-within:ring-blue-100 w-full flex items-center min-h-[50px]">
                        
                        <textarea 
                            name="question" 
                            id="messageInput"
                            class="border-none outline-none p-3 text-base text-blue-900 bg-transparent resize-none min-h-[24px] max-h-[100px] leading-snug flex-1 input-scrollbar placeholder-gray-500"
                            placeholder="Escribe tu pregunta..."
                            rows="1"
                        ></textarea>
                        
                        <button 
                            class="gradient-primary text-white border-none rounded-lg w-10 h-10 flex items-center justify-center cursor-pointer transition-all duration-200 text-sm shadow-md hover:gradient-secondary hover-lift focus:outline-none focus:ring-2 focus:ring-blue-200 ml-2 flex-shrink-0"
                            id="sendButton" 
                            type="submit"
                        >
                            <i class="fas fa-paper-plane"></i>
                        </button>
                        
                        <button 
                            type="button" 
                            class="gradient-primary text-white border-none rounded-lg w-10 h-10 flex items-center justify-center cursor-pointer transition-all duration-200 text-sm shadow-md hover:gradient-secondary hover-lift focus:outline-none focus:ring-2 focus:ring-blue-200 ml-2 flex-shrink-0"
                            id="micButton" 
                            title="Hablar"
                        >
                            <i class="fas fa-microphone"></i>
                        </button>
                        
                        <input type="file" id="imageInput" accept="image/*" class="hidden">
                        <button  
                            class="gradient-primary text-white border-none rounded-lg w-10 h-10 flex items-center justify-center cursor-pointer transition-all duration-200 text-sm shadow-md hover:gradient-secondary hover-lift focus:outline-none focus:ring-2 focus:ring-blue-200 ml-2 flex-shrink-0"
                            type="button" 
                            id="imageButton" 
                            title="Subir imagen"
                        >
                            <i class="fas fa-image"></i>
                        </button>
                        
                    </div>
                    
                    <span id="recordingStatus" class="ml-2 text-red-500 hidden">Grabando...</span>
                </div>
            </form>
        </div>
        
        </div>
        
    </div>
</main>

<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
<script src="{% static 'js/llm.js' %}"></script>
{% endblock %}